"use strict";(self.webpackChunkrsm=self.webpackChunkrsm||[]).push([[445],{9445:(Ra,be,x)=>{x.d(be,{h:()=>Na,w:()=>Fa});var z=x(467),f=x(4438);class gt{constructor(e){if(this.crashes=[],this.state="initializing",this._now=Date.now,this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=r=>{const n="error"in r?r.error:r.reason;n instanceof Error&&this._handleError(n,r)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,r){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(r)}off(e,r){this._listeners[e]=this._listeners[e].filter(n=>n!==r)}_fire(e,...r){const n=this._listeners[e]||[];for(const o of n)o.apply(this,[null,...r])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,r){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:r instanceof ErrorEvent?r.filename:void 0,lineno:r instanceof ErrorEvent?r.lineno:void 0,colno:r instanceof ErrorEvent?r.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&null!=e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){return this.crashes.length<=this._crashNumberLimit||(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}function q(t,e=new Set){const r=[t],n=new Set;let o=0;for(;r.length>o;){const s=r[o++];if(!n.has(s)&&ye(s)&&!e.has(s))if(n.add(s),Symbol.iterator in s)try{for(const i of s)r.push(i)}catch{}else for(const i in s)"defaultValue"!==i&&r.push(s[i])}return n}function ye(t){const e=Object.prototype.toString.call(t),r=typeof t;return!("number"===r||"boolean"===r||"string"===r||"symbol"===r||"function"===r||"[object Date]"===e||"[object RegExp]"===e||"[object Module]"===e||null==t||t._watchdogExcluded||t instanceof EventTarget||t instanceof Event)}const T=function Te(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},bt="object"==typeof global&&global&&global.Object===Object&&global;var Ce="object"==typeof self&&self&&self.Object===Object&&self;const y=bt||Ce||Function("return this")(),Q=function(){return y.Date.now()};var Oe=/\s/;var xe=/^\s+/;const Pe=function je(t){return t&&t.slice(0,function Se(t){for(var e=t.length;e--&&Oe.test(t.charAt(e)););return e}(t)+1).replace(xe,"")},j=y.Symbol;var yt=Object.prototype,Ne=yt.hasOwnProperty,De=yt.toString,B=j?j.toStringTag:void 0;var Re=Object.prototype.toString;var mt=j?j.toStringTag:void 0;const w=function ke(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":mt&&mt in Object(t)?function Fe(t){var e=Ne.call(t,B),r=t[B];try{t[B]=void 0;var n=!0}catch{}var o=De.call(t);return n&&(e?t[B]=r:delete t[B]),o}(t):function Le(t){return Re.call(t)}(t)},v=function Ge(t){return null!=t&&"object"==typeof t};var $e=/^[-+]0x[0-9a-f]+$/i,ze=/^0b[01]+$/i,qe=/^0o[0-7]+$/i,Qe=parseInt;const vt=function Ze(t){if("number"==typeof t)return t;if(function Ve(t){return"symbol"==typeof t||v(t)&&"[object Symbol]"==w(t)}(t))return NaN;if(T(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=T(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Pe(t);var r=ze.test(t);return r||qe.test(t)?Qe(t.slice(2),r?2:8):$e.test(t)?NaN:+t};var Ye=Math.max,tr=Math.min;const sr=function or(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return T(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),function er(t,e,r){var n,o,s,i,a,h,c=0,_=!1,p=!1,C=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function M(l){var E=n,K=o;return n=o=void 0,c=l,i=t.apply(K,E)}function m(l){var E=l-h;return void 0===h||E>=e||E<0||p&&l-c>=s}function b(){var l=Q();if(m(l))return ge(l);a=setTimeout(b,function $(l){var pe=e-(l-h);return p?tr(pe,s-(l-c)):pe}(l))}function ge(l){return a=void 0,C&&n?M(l):(n=o=void 0,i)}function ft(){var l=Q(),E=m(l);if(n=arguments,o=this,h=l,E){if(void 0===a)return function _t(l){return c=l,a=setTimeout(b,e),_?M(l):i}(h);if(p)return clearTimeout(a),a=setTimeout(b,e),M(h)}return void 0===a&&(a=setTimeout(b,e)),i}return e=vt(e)||0,T(r)&&(_=!!r.leading,s=(p="maxWait"in r)?Ye(vt(r.maxWait)||0,e):s,C="trailing"in r?!!r.trailing:C),ft.cancel=function Ma(){void 0!==a&&clearTimeout(a),c=0,n=h=o=a=void 0},ft.flush=function Ba(){return void 0===a?i:ge(Q())},ft}(t,e,{leading:n,maxWait:e,trailing:o})},Ct=function ir(t,e){return function(r){return t(e(r))}},Z=Ct(Object.getPrototypeOf,Object);var Et=Function.prototype.toString,dr=Object.prototype.hasOwnProperty,lr=Et.call(Object);const wt=function gr(t){return v(t)&&1===t.nodeType&&!function _r(t){if(!v(t)||"[object Object]"!=w(t))return!1;var e=Z(t);if(null===e)return!0;var r=dr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Et.call(r)==lr}(t)},Ot=function yr(t,e){return t===e||t!=t&&e!=e},k=function mr(t,e){for(var r=t.length;r--;)if(Ot(t[r][0],e))return r;return-1};var vr=Array.prototype.splice;function P(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}P.prototype.clear=function pr(){this.__data__=[],this.size=0},P.prototype.delete=function Cr(t){var e=this.__data__,r=k(e,t);return!(r<0||(r==e.length-1?e.pop():vr.call(e,r,1),--this.size,0))},P.prototype.get=function wr(t){var e=this.__data__,r=k(e,t);return r<0?void 0:e[r][1]},P.prototype.has=function Sr(t){return k(this.__data__,t)>-1},P.prototype.set=function xr(t,e){var r=this.__data__,n=k(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};const G=P,St=function kr(t){if(!T(t))return!1;var e=w(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};var t,Gr=y["__core-js_shared__"],At=(t=/[^.]+$/.exec(Gr&&Gr.keys&&Gr.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";var $r=Function.prototype.toString;const O=function zr(t){if(null!=t){try{return $r.call(t)}catch{}try{return t+""}catch{}}return""};var Qr=/^\[object .+?Constructor\]$/,en=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const nn=function rn(t){return!(!T(t)||function Hr(t){return!!At&&At in t}(t))&&(St(t)?en:Qr).test(O(t))},S=function an(t,e){var r=function on(t,e){return t?.[e]}(t,e);return nn(r)?r:void 0},R=S(y,"Map"),L=S(Object,"create");var pn=Object.prototype.hasOwnProperty;var Tn=Object.prototype.hasOwnProperty;function I(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}I.prototype.clear=function un(){this.__data__=L?L(null):{},this.size=0},I.prototype.delete=function ln(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},I.prototype.get=function bn(t){var e=this.__data__;if(L){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return pn.call(e,t)?e[t]:void 0},I.prototype.has=function vn(t){var e=this.__data__;return L?void 0!==e[t]:Tn.call(e,t)},I.prototype.set=function wn(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=L&&void 0===e?"__lodash_hash_undefined__":e,this};const xt=I,H=function Pn(t,e){var r=t.__data__;return function xn(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map};function N(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}N.prototype.clear=function Sn(){this.size=0,this.__data__={hash:new xt,map:new(R||G),string:new xt}},N.prototype.delete=function In(t){var e=H(this,t).delete(t);return this.size-=e?1:0,e},N.prototype.get=function Dn(t){return H(this,t).get(t)},N.prototype.has=function Mn(t){return H(this,t).has(t)},N.prototype.set=function Rn(t,e){var r=H(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};const Wn=N;function D(t){var e=this.__data__=new G(t);this.size=e.size}D.prototype.clear=function Pr(){this.__data__=new G,this.size=0},D.prototype.delete=function Nr(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},D.prototype.get=function Fr(t){return this.__data__.get(t)},D.prototype.has=function Br(t){return this.__data__.has(t)},D.prototype.set=function Kn(t,e){var r=this.__data__;if(r instanceof G){var n=r.__data__;if(!R||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Wn(n)}return r.set(t,e),this.size=r.size,this};const Gn=D;var Jn=function(){try{var t=S(Object,"defineProperty");return t({},"",{}),t}catch{}}();const jt=Jn,Pt=function $n(t,e,r){"__proto__"==e&&jt?jt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var qn=Object.prototype.hasOwnProperty;const It=function Qn(t,e,r){var n=t[e];(!qn.call(t,e)||!Ot(n,r)||void 0===r&&!(e in t))&&Pt(t,e,r)},V=function Zn(t,e,r,n){var o=!r;r||(r={});for(var s=-1,i=e.length;++s<i;){var a=e[s],h=n?n(r[a],t[a],a,r,t):void 0;void 0===h&&(h=t[a]),o?Pt(r,a,h):It(r,a,h)}return r},Nt=function eo(t){return v(t)&&"[object Arguments]"==w(t)};var Dt=Object.prototype,ro=Dt.hasOwnProperty,no=Dt.propertyIsEnumerable,oo=Nt(function(){return arguments}())?Nt:function(t){return v(t)&&ro.call(t,"callee")&&!no.call(t,"callee")};const so=oo,Y=Array.isArray;var Ft="object"==typeof exports&&exports&&!exports.nodeType&&exports,Mt=Ft&&"object"==typeof module&&module&&!module.nodeType&&module,Bt=Mt&&Mt.exports===Ft?y.Buffer:void 0;const Rt=(Bt?Bt.isBuffer:void 0)||function ao(){return!1};var fo=/^(?:0|[1-9]\d*)$/;const po=function go(t,e){var r=typeof t;return!!(e=e??9007199254740991)&&("number"==r||"symbol"!=r&&fo.test(t))&&t>-1&&t%1==0&&t<e},Lt=function yo(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Arguments]"]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d["[object Map]"]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1;const tt=function Vo(t){return function(e){return t(e)}};var Wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,W=Wt&&"object"==typeof module&&module&&!module.nodeType&&module,et=W&&W.exports===Wt&&bt.process;const F=function(){try{return W&&W.require&&W.require("util").types||et&&et.binding&&et.binding("util")}catch{}}();var Ut=F&&F.isTypedArray;const qo=Ut?tt(Ut):function Go(t){return v(t)&&Lt(t.length)&&!!d[w(t)]};var Zo=Object.prototype.hasOwnProperty;const Kt=function Xo(t,e){var r=Y(t),n=!r&&so(t),o=!r&&!n&&Rt(t),s=!r&&!n&&!o&&qo(t),i=r||n||o||s,a=i?function Xn(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],h=a.length;for(var c in t)(e||Zo.call(t,c))&&(!i||!("length"==c||o&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||po(c,h)))&&a.push(c);return a};var Yo=Object.prototype;const rt=function ts(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Yo)},rs=Ct(Object.keys,Object);var os=Object.prototype.hasOwnProperty;const kt=function as(t){return null!=t&&Lt(t.length)&&!St(t)},nt=function cs(t){return kt(t)?Kt(t):function ss(t){if(!rt(t))return rs(t);var e=[];for(var r in Object(t))os.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)};var fs=Object.prototype.hasOwnProperty;const ps=function gs(t){if(!T(t))return function ds(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=rt(t),r=[];for(var n in t)"constructor"==n&&(e||!fs.call(t,n))||r.push(n);return r},ot=function bs(t){return kt(t)?Kt(t,!0):ps(t)};var Gt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ht=Gt&&"object"==typeof module&&module&&!module.nodeType&&module,Vt=Ht&&Ht.exports===Gt?y.Buffer:void 0,Jt=Vt?Vt.allocUnsafe:void 0;const $t=function As(){return[]};var js=Object.prototype.propertyIsEnumerable,zt=Object.getOwnPropertySymbols,Ps=zt?function(t){return null==t?[]:(t=Object(t),function Os(t,e){for(var r=-1,n=null==t?0:t.length,o=0,s=[];++r<n;){var i=t[r];e(i,r,t)&&(s[o++]=i)}return s}(zt(t),function(e){return js.call(t,e)}))}:$t;const st=Ps,qt=function Ds(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t};var Ms=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)qt(e,st(t)),t=Z(t);return e}:$t;const Qt=Ms,Zt=function Ls(t,e,r){var n=e(t);return Y(t)?n:qt(n,r(t))},Us=function Ws(t){return Zt(t,nt,st)},ks=function Ks(t){return Zt(t,ot,Qt)},it=S(y,"DataView"),at=S(y,"Promise"),ct=S(y,"Set"),ht=S(y,"WeakMap");var Xt="[object Map]",Yt="[object Promise]",te="[object Set]",ee="[object WeakMap]",re="[object DataView]",zs=O(it),qs=O(R),Qs=O(at),Zs=O(ct),Xs=O(ht),A=w;(it&&A(new it(new ArrayBuffer(1)))!=re||R&&A(new R)!=Xt||at&&A(at.resolve())!=Yt||ct&&A(new ct)!=te||ht&&A(new ht)!=ee)&&(A=function(t){var e=w(t),r="[object Object]"==e?t.constructor:void 0,n=r?O(r):"";if(n)switch(n){case zs:return re;case qs:return Xt;case Qs:return Yt;case Zs:return te;case Xs:return ee}return e});const ut=A;var ti=Object.prototype.hasOwnProperty;const ne=y.Uint8Array,dt=function oi(t){var e=new t.constructor(t.byteLength);return new ne(e).set(new ne(t)),e};var ai=/\w*$/;var oe=j?j.prototype:void 0,se=oe?oe.valueOf:void 0;const Fi=function Di(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return dt(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return function si(t,e){var r=e?dt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function li(t,e){var r=e?dt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return function ci(t){var e=new t.constructor(t.source,ai.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function ui(t){return se?Object(se.call(t)):{}}(t)}};var ie=Object.create,Mi=function(){function t(){}return function(e){if(!T(e))return{};if(ie)return ie(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const Bi=Mi;var ae=F&&F.isMap;const Gi=ae?tt(ae):function Ui(t){return v(t)&&"[object Map]"==ut(t)};var ce=F&&F.isSet;const zi=ce?tt(ce):function Vi(t){return v(t)&&"[object Set]"==ut(t)};var he="[object Arguments]",ue="[object Function]",de="[object Object]",u={};u[he]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object DataView]"]=u["[object Boolean]"]=u["[object Date]"]=u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Map]"]=u["[object Number]"]=u[de]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object Symbol]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Error]"]=u[ue]=u["[object WeakMap]"]=!1;const va=function J(t,e,r,n,o,s){var i,a=1&e,h=2&e,c=4&e;if(r&&(i=o?r(t,n,o,s):r(t)),void 0!==i)return i;if(!T(t))return t;var _=Y(t);if(_){if(i=function ei(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ti.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!a)return function Es(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t,i)}else{var p=ut(t),C=p==ue||"[object GeneratorFunction]"==p;if(Rt(t))return function vs(t,e){if(e)return t.slice();var r=t.length,n=Jt?Jt(r):new t.constructor(r);return t.copy(n),n}(t,a);if(p==de||p==he||C&&!o){if(i=h||C?{}:function Ri(t){return"function"!=typeof t.constructor||rt(t)?{}:Bi(Z(t))}(t),!a)return h?function Bs(t,e){return V(t,Qt(t),e)}(t,function ys(t,e){return t&&V(e,ot(e),t)}(i,t)):function Is(t,e){return V(t,st(t),e)}(t,function hs(t,e){return t&&V(e,nt(e),t)}(i,t))}else{if(!u[p])return o?t:{};i=Fi(t,p,a)}}s||(s=new Gn);var M=s.get(t);if(M)return M;s.set(t,i),zi(t)?t.forEach(function(m){i.add(J(m,e,r,m,t,s))}):Gi(t)&&t.forEach(function(m,b){i.set(b,J(m,e,r,b,t,s))});var $=_?void 0:(c?h?ks:Us:h?ot:nt)(t);return function Hn(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}($||t,function(m,b){$&&(m=t[b=m]),It(i,b,J(m,e,r,b,t,s))}),i};class le extends gt{constructor(e,r={}){super(r),this._editor=null,this._lifecyclePromise=null,this._initUsingData=!0,this._editables={},this._throttledSave=sr(this._save.bind(this),"number"==typeof r.saveInterval?r.saveInterval:5e3),e&&(this._creator=(n,o)=>e.create(n,o)),this._destructor=n=>n.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},r=[],n=this._config.rootsAttributes||{},o={};for(const[i,a]of Object.entries(this._data.roots))a.isLoaded?(e[i]="",o[i]=n[i]||{}):r.push(i);const s={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:r,rootsAttributes:o,_watchdogInitialData:this._data};return delete s.initialData,s.extraPlugins.push(Sa),this._initUsingData?this.create(e,s,s.context):wt(this._elementOrData)?this.create(this._elementOrData,s,s.context):this.create(this._editables,s,s.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,r=this._config,n){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],this._config=this._cloneEditorConfiguration(r)||{},this._config.context=n,this._creator(e,this._config))).then(o=>{this._editor=o,o.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=o.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(r){console.error(r,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,r=e.model.document.roots.filter(a=>a.isAttached()&&"$graveyard"!=a.rootName),{plugins:n}=e,o=n.has("CommentsRepository")&&n.get("CommentsRepository"),s=n.has("TrackChanges")&&n.get("TrackChanges"),i={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};r.forEach(a=>{i.roots[a.rootName]={content:JSON.stringify(Array.from(a.getChildren())),attributes:JSON.stringify(Array.from(a.getAttributes())),isLoaded:a._isLoaded}});for(const a of e.model.markers)a._affectsData&&(i.markers[a.name]={rangeJSON:a.getRange().toJSON(),usingOperation:a._managedUsingOperations,affectsData:a._affectsData});return o&&(i.commentThreads=JSON.stringify(o.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),s&&(i.suggestions=JSON.stringify(s.getSuggestions({toJSON:!0,skipNotAttached:!0}))),i}_getEditables(){const e={};for(const r of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(r);n&&(e[r]=n)}return e}_isErrorComingFromThisItem(e){return function pt(t,e,r=new Set){if(t===e&&function me(t){return"object"==typeof t&&null!==t}(t))return!0;const n=q(t,r),o=q(e,r);for(const s of n)if(o.has(s))return!0;return!1}(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return function wa(t,e){return va(t,5,e="function"==typeof e?e:void 0)}(e,(r,n)=>{if(wt(r)||"context"===n)return r})}}class Sa{constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},r=>{this._restoreCollaborationData(),this._restoreEditorData(r)}),this.editor.data.fire("ready")},{priority:999})}_createNode(e,r){if("name"in r){const n=e.createElement(r.name,r.attributes);if(r.children)for(const o of r.children)n._appendChild(this._createNode(e,o));return n}return e.createText(r.data,r.attributes)}_restoreEditorData(e){const r=this.editor;Object.entries(this._data.roots).forEach(([n,{content:o,attributes:s}])=>{const i=JSON.parse(o),a=JSON.parse(s),h=r.model.document.getRoot(n);for(const[c,_]of a)e.setAttribute(c,_,h);for(const c of i){const _=this._createNode(e,c);e.insert(_,h,"end")}}),Object.entries(this._data.markers).forEach(([n,o])=>{const{document:s}=r.model,{rangeJSON:{start:i,end:a},...h}=o,c=s.getRoot(i.root),_=e.createPositionFromPath(c,i.path,i.stickiness),p=e.createPositionFromPath(c,a.path,a.stickiness),C=e.createRange(_,p);e.addMarker(n,{range:C,...h})})}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),r=JSON.parse(this._data.suggestions);e.forEach(n=>{const o=this.editor.config.get("collaboration.channelId"),s=this.editor.plugins.get("CommentsRepository");s.hasCommentThread(n.threadId)&&s.getCommentThread(n.threadId).remove(),s.addCommentThread({channelId:o,...n})}),r.forEach(n=>{const o=this.editor.plugins.get("TrackChangesEditing");o.hasSuggestion(n.id)?o.getSuggestion(n.id).attributes=n.attributes:o.addSuggestionData(n)})}}Symbol("MainQueueId");var xa=x(1594),fe=x(9417),ja=x(177);function Pa(t,e){}const g=new Array(256).fill(0).map((t,e)=>("0"+e.toString(16)).slice(-2)),lt="Lock from Angular integration (@ckeditor/ckeditor5-angular)";let Na=(()=>{class t{constructor(r,n){this.config={},this.data="",this.tagName="div",this.disableTwoWayDataBinding=!1,this.ready=new f.bkB,this.change=new f.bkB,this.blur=new f.bkB,this.focus=new f.bkB,this.error=new f.bkB,this.initiallyDisabled=!1,this.isEditorSettingData=!1,this.id=function Ia(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,r=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return"e"+g[255&t]+g[t>>8&255]+g[t>>16&255]+g[t>>24&255]+g[255&e]+g[e>>8&255]+g[e>>16&255]+g[e>>24&255]+g[255&r]+g[r>>8&255]+g[r>>16&255]+g[r>>24&255]+g[255&n]+g[n>>8&255]+g[n>>16&255]+g[n>>24&255]}(),this.ngZone=n,this.elementRef=r;const{CKEDITOR_VERSION:o}=window;if(o){const[s]=o.split(".").map(Number);s<37&&console.warn("The <CKEditor> component requires using CKEditor 5 in version 37 or higher.")}else console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.')}set disabled(r){this.setDisabledState(r)}get disabled(){return this.editorInstance?this.editorInstance.isReadOnly:this.initiallyDisabled}get editorInstance(){let r=this.editorWatchdog;return this.watchdog&&(r=this.watchdog._watchdogs.get(this.id)),r?r.editor:null}getId(){return this.id}ngOnChanges(r){Object.prototype.hasOwnProperty.call(r,"data")&&r.data&&!r.data.isFirstChange()&&this.writeValue(r.data.currentValue)}ngAfterViewInit(){this.attachToWatchdog()}ngOnDestroy(){var r=this;return(0,z.A)(function*(){r.watchdog?yield r.watchdog.remove(r.id):r.editorWatchdog&&r.editorWatchdog.editor&&(yield r.editorWatchdog.destroy(),r.editorWatchdog=void 0)})()}writeValue(r){null===r&&(r=""),this.editorInstance?(this.isEditorSettingData=!0,this.editorInstance.data.set(r),this.isEditorSettingData=!1):(this.data=r,this.ready.pipe((0,xa.$)()).subscribe(n=>{n.data.set(this.data)}))}registerOnChange(r){this.cvaOnChange=r}registerOnTouched(r){this.cvaOnTouched=r}setDisabledState(r){this.editorInstance&&(r?this.editorInstance.enableReadOnlyMode(lt):this.editorInstance.disableReadOnlyMode(lt)),this.initiallyDisabled=r}attachToWatchdog(){var r=this;const n=(h,c)=>this.ngZone.runOutsideAngular((0,z.A)(function*(){r.elementRef.nativeElement.appendChild(h);const _=yield r.editor.create(h,c);return r.initiallyDisabled&&_.enableReadOnlyMode(lt),r.ngZone.run(()=>{r.ready.emit(_)}),r.setUpEditorEvents(_),_})),o=function(){var h=(0,z.A)(function*(c){yield c.destroy(),r.elementRef.nativeElement.removeChild(r.editorElement)});return function(_){return h.apply(this,arguments)}}(),s=h=>{(function Da(t){return t.observed||t.observers.length>0})(this.error)&&this.ngZone.run(()=>this.error.emit(h))},i=document.createElement(this.tagName),a=this.getConfig();if(this.editorElement=i,this.watchdog)this.watchdog.add({id:this.id,type:"editor",creator:n,destructor:o,sourceElementOrData:i,config:a}).catch(h=>{s(h)}),this.watchdog.on("itemError",(h,{itemId:c})=>{c===this.id&&s()});else{const h=new le(this.editor,this.editorWatchdogConfig);h.setCreator(n),h.setDestructor(o),h.on("error",s),this.editorWatchdog=h,this.ngZone.runOutsideAngular(()=>{h.create(i,a).catch(c=>{s(c)})})}}getConfig(){if(this.data&&this.config.initialData)throw new Error("Editor data should be provided either using `config.initialData` or `data` properties.");const r={...this.config},n=this.config.initialData||this.data;return n&&(r.initialData=n),r}setUpEditorEvents(r){const o=r.editing.view.document;r.model.document.on("change:data",s=>{this.ngZone.run(()=>{if(!this.disableTwoWayDataBinding){if(this.cvaOnChange&&!this.isEditorSettingData){const i=r.data.get();this.cvaOnChange(i)}this.change.emit({event:s,editor:r})}})}),o.on("focus",s=>{this.ngZone.run(()=>{this.focus.emit({event:s,editor:r})})}),o.on("blur",s=>{this.ngZone.run(()=>{this.cvaOnTouched&&this.cvaOnTouched(),this.blur.emit({event:s,editor:r})})})}}return t.\u0275fac=function(r){return new(r||t)(f.rXU(f.aKT),f.rXU(f.SKi))},t.\u0275cmp=f.VBU({type:t,selectors:[["ckeditor"]],inputs:{editor:"editor",config:"config",data:"data",tagName:"tagName",watchdog:"watchdog",editorWatchdogConfig:"editorWatchdogConfig",disableTwoWayDataBinding:"disableTwoWayDataBinding",disabled:"disabled"},outputs:{ready:"ready",change:"change",blur:"blur",focus:"focus",error:"error"},features:[f.Jv_([{provide:fe.kq,useExisting:(0,f.Rfq)(()=>t),multi:!0}]),f.OA$],decls:1,vars:0,template:function(r,n){1&r&&f.DNE(0,Pa,0,0,"ng-template")},encapsulation:2}),t})(),Fa=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=f.$C({type:t}),t.\u0275inj=f.G2t({imports:[[fe.YN,ja.MD]]}),t})()}}]);